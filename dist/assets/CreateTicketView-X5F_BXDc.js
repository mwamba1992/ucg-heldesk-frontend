import{d as x,z as m,X as u,R as M,B,e as l,w as a,$ as v,x as c,g as U,S as V,u as L,o as P,j as r,T as F,n as g,k as H,r as N,s as R,v as y,a0 as S,V as A,f as C,Z as b,H as $,a1 as q,a2 as D,p as E,l as s,a3 as j,N as z}from"./index-Cix3CRG3.js";const W=x({__name:"CreateTicketView",setup(G){const n=L(),d=m(!1),p=m([]),t=m({title:"",description:"",categoryId:"",priority:u.MEDIUM,location:""}),k={title:[o=>!!o||"Title is required"]},w=[{title:"Critical",value:u.CRITICAL,color:"red"},{title:"High",value:u.HIGH,color:"orange"},{title:"Medium",value:u.MEDIUM,color:"amber"},{title:"Low",value:u.LOW,color:"green"}];async function T(){try{const o=await V.get("/categories");p.value=o.data}catch(o){console.error("Failed to fetch categories:",o)}}async function f(){if(t.value.title){d.value=!0;try{const o={title:t.value.title,priority:t.value.priority};t.value.description&&(o.description=t.value.description),t.value.categoryId&&(o.categoryId=t.value.categoryId),t.value.location&&(o.location=t.value.location);const e=await V.post("/tickets",o);n.push(`/tickets/${e.data.id}`)}catch(o){console.error("Failed to create ticket:",o)}finally{d.value=!1}}}return M(T),(o,e)=>(P(),B("div",null,[l(c,{variant:"text","prepend-icon":"mdi-arrow-left",class:"mb-4",onClick:e[0]||(e[0]=i=>v(n).push("/tickets"))},{default:a(()=>[...e[7]||(e[7]=[r(" Back to Tickets ",-1)])]),_:1}),l(U,{"max-width":"800",class:"mx-auto"},{default:a(()=>[l(F,null,{default:a(()=>[l(g,{class:"mr-2"},{default:a(()=>[...e[8]||(e[8]=[r("mdi-ticket-plus",-1)])]),_:1}),e[9]||(e[9]=r(" Create New Ticket ",-1))]),_:1}),l(H,null,{default:a(()=>[l(N,{onSubmit:R(f,["prevent"])},{default:a(()=>[l(y,{modelValue:t.value.title,"onUpdate:modelValue":e[1]||(e[1]=i=>t.value.title=i),label:"Title",rules:k.title,required:"",class:"mb-4",placeholder:"Brief description of the issue"},null,8,["modelValue","rules"]),l(S,{modelValue:t.value.description,"onUpdate:modelValue":e[2]||(e[2]=i=>t.value.description=i),label:"Description",rows:"4",class:"mb-4",placeholder:"Please provide details about the issue..."},null,8,["modelValue"]),l(A,null,{default:a(()=>[l(C,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:t.value.categoryId,"onUpdate:modelValue":e[3]||(e[3]=i=>t.value.categoryId=i),items:p.value,"item-title":"name","item-value":"id",label:"Category",clearable:""},null,8,["modelValue","items"])]),_:1}),l(C,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:t.value.priority,"onUpdate:modelValue":e[4]||(e[4]=i=>t.value.priority=i),items:w,label:"Priority"},{item:a(({props:i,item:I})=>[l($,q(D(i)),{prepend:a(()=>[l(g,{color:I.raw.color},{default:a(()=>[...e[10]||(e[10]=[r("mdi-circle",-1)])]),_:1},8,["color"])]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{modelValue:t.value.location,"onUpdate:modelValue":e[5]||(e[5]=i=>t.value.location=i),label:"Location",placeholder:"e.g., Building A, Floor 2",class:"mb-4"},null,8,["modelValue"]),l(E,{type:"info",variant:"tonal",class:"mb-4"},{default:a(()=>[...e[11]||(e[11]=[s("strong",null,"Priority Guidelines:",-1),s("ul",{class:"mt-2"},[s("li",null,[s("strong",null,"Critical:"),r(" Complete system outage, security breach")]),s("li",null,[s("strong",null,"High:"),r(" Major functionality broken, affecting multiple users")]),s("li",null,[s("strong",null,"Medium:"),r(" Single user affected, workaround available")]),s("li",null,[s("strong",null,"Low:"),r(" Minor issue, enhancement request")])],-1)])]),_:1})]),_:1})]),_:1}),l(j,null,{default:a(()=>[l(z),l(c,{variant:"text",onClick:e[6]||(e[6]=i=>v(n).push("/tickets"))},{default:a(()=>[...e[12]||(e[12]=[r("Cancel",-1)])]),_:1}),l(c,{color:"primary",loading:d.value,disabled:!t.value.title,onClick:f},{default:a(()=>[...e[13]||(e[13]=[r(" Create Ticket ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]))}});export{W as default};
