import{d as R,W as d,X as v,Y as A,R as L,B as O,l as o,e as l,w as a,x as y,g as E,S as U,z as c,u as G,o as M,j as n,k as z,V as B,f as k,v as H,Z as x,_ as W,n as $,t as u,P as I}from"./index-Cix3CRG3.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"d-flex justify-space-between align-center mb-6"},F=["onClick"],X=["onClick"],Y={class:"text-center py-8"},Z=R({__name:"TicketsView",setup(J){const C=G(),f=c(!1),V=c([]),N=c(0),p=c(1),m=c(10),s=c({status:"",priority:"",search:""}),T=[{title:"All Statuses",value:""},{title:"New",value:d.NEW},{title:"Assigned",value:d.ASSIGNED},{title:"In Progress",value:d.IN_PROGRESS},{title:"Pending",value:d.PENDING},{title:"Resolved",value:d.RESOLVED},{title:"Closed",value:d.CLOSED}],w=[{title:"All Priorities",value:""},{title:"Critical",value:v.CRITICAL},{title:"High",value:v.HIGH},{title:"Medium",value:v.MEDIUM},{title:"Low",value:v.LOW}],D={NEW:"blue",ASSIGNED:"purple",IN_PROGRESS:"orange",PENDING:"amber",RESOLVED:"green",CLOSED:"grey",CANCELLED:"red"},P={CRITICAL:"red",HIGH:"orange",MEDIUM:"amber",LOW:"green"},_=[{title:"Ticket #",key:"ticketNumber",sortable:!0},{title:"Title",key:"title",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Priority",key:"priority",sortable:!0},{title:"Requester",key:"requester.fullName",sortable:!1},{title:"Assigned To",key:"assignee.fullName",sortable:!1},{title:"Created",key:"createdAt",sortable:!0},{title:"Actions",key:"actions",sortable:!1}];async function b(){f.value=!0;try{const i=new URLSearchParams({page:p.value.toString(),limit:m.value.toString()});s.value.status&&i.append("status",s.value.status),s.value.priority&&i.append("priority",s.value.priority),s.value.search&&i.append("search",s.value.search);const t=await U.get(`/tickets?${i}`);V.value=t.data.data,N.value=t.data.meta.total}catch(i){console.error("Failed to fetch tickets:",i)}finally{f.value=!1}}function h(i){return new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function g(i){C.push(`/tickets/${i.id}`)}function S(){C.push("/tickets/new")}return A([p,m,s],b,{deep:!0}),L(b),(i,t)=>(M(),O("div",null,[o("div",j,[t[6]||(t[6]=o("div",null,[o("h1",{class:"text-h4"},"Tickets"),o("p",{class:"text-body-2 text-grey"},"Manage support tickets")],-1)),l(y,{color:"primary","prepend-icon":"mdi-plus",onClick:S},{default:a(()=>[...t[5]||(t[5]=[n(" New Ticket ",-1)])]),_:1})]),l(E,{class:"mb-4"},{default:a(()=>[l(z,null,{default:a(()=>[l(B,null,{default:a(()=>[l(k,{cols:"12",md:"4"},{default:a(()=>[l(H,{modelValue:s.value.search,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value.search=e),label:"Search","prepend-inner-icon":"mdi-magnify",clearable:"","hide-details":"",density:"compact"},null,8,["modelValue"])]),_:1}),l(k,{cols:"12",md:"4"},{default:a(()=>[l(x,{modelValue:s.value.status,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value.status=e),items:T,label:"Status","hide-details":"",density:"compact"},null,8,["modelValue"])]),_:1}),l(k,{cols:"12",md:"4"},{default:a(()=>[l(x,{modelValue:s.value.priority,"onUpdate:modelValue":t[2]||(t[2]=e=>s.value.priority=e),items:w,label:"Priority","hide-details":"",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(E,null,{default:a(()=>[l(W,{headers:_,items:V.value,loading:f.value,"items-per-page":m.value,page:p.value,"items-length":N.value,"onUpdate:page":t[3]||(t[3]=e=>p.value=e),"onUpdate:itemsPerPage":t[4]||(t[4]=e=>m.value=e),class:"elevation-0"},{"item.ticketNumber":a(({item:e})=>[o("span",{class:"font-weight-medium text-primary cursor-pointer",onClick:r=>g(e)},u(e.ticketNumber),9,F)]),"item.title":a(({item:e})=>[o("span",{class:"cursor-pointer",onClick:r=>g(e)},u(e.title),9,X)]),"item.status":a(({item:e})=>[l(I,{color:D[e.status],size:"small",variant:"tonal"},{default:a(()=>[n(u(e.status.replace("_"," ")),1)]),_:2},1032,["color"])]),"item.priority":a(({item:e})=>[l(I,{color:P[e.priority],size:"small",variant:"tonal"},{default:a(()=>[n(u(e.priority),1)]),_:2},1032,["color"])]),"item.requester.fullName":a(({item:e})=>{var r;return[n(u(((r=e.requester)==null?void 0:r.fullName)||"-"),1)]}),"item.assignee.fullName":a(({item:e})=>{var r;return[n(u(((r=e.assignee)==null?void 0:r.fullName)||"Unassigned"),1)]}),"item.createdAt":a(({item:e})=>[n(u(h(e.createdAt)),1)]),"item.actions":a(({item:e})=>[l(y,{icon:"mdi-eye",variant:"text",size:"small",onClick:r=>g(e)},null,8,["onClick"])]),"no-data":a(()=>[o("div",Y,[l($,{size:"64",color:"grey-lighten-1"},{default:a(()=>[...t[7]||(t[7]=[n("mdi-ticket-outline",-1)])]),_:1}),t[9]||(t[9]=o("p",{class:"text-h6 mt-4"},"No tickets found",-1)),t[10]||(t[10]=o("p",{class:"text-body-2 text-grey"},"Create your first ticket to get started",-1)),l(y,{color:"primary",class:"mt-4",onClick:S},{default:a(()=>[...t[8]||(t[8]=[n(" Create Ticket ",-1)])]),_:1})])]),_:1},8,["items","loading","items-per-page","page","items-length"])]),_:1})]))}}),ee=q(Z,[["__scopeId","data-v-8a8f2b6d"]]);export{ee as default};
